!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("Game",[],t):"object"==typeof exports?exports.Game=t():e.Game=t()}(this,function(){return function(e){function t(a){if(r[a])return r[a].exports;var o=r[a]={i:a,l:!1,exports:{}};return e[a].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var r={};return t.m=e,t.c=r,t.d=function(e,r,a){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:a})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t.p="undefined"!=typeof window&&window.__STATICS_BASE_URL__||t.p,t(t.s=5)}([function(e,t,r){"use strict";function a(e,t,r){if(!e||!t)return null;var a=t.clone().normalize().multiply(r,r);return Phaser.Point.add(e,a)}function o(e){return!e&&(e={}),JSON.parse(JSON.stringify(e))}Object.defineProperty(t,"__esModule",{value:!0}),t.default={clone:o,moveWithSpeed:a}},function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e){return u.default[e]}function s(e){var t=JSON.parse(JSON.stringify(i.default[e]));return!t.id&&(t.id=e),t}Object.defineProperty(t,"__esModule",{value:!0});var n=r(14),i=a(n),l=r(21),u=a(l);t.default={getRuleConfig:o,getConfig:s}},function(e,t){function r(e,t){if(!(this instanceof r))return new r(e,t);this.x=e||0,this.y=t||0}function a(e,t){return Math.floor(Math.random()*(t-e+1)+e)}function o(e){return e*n}function s(e){return e/n}e.exports=r,r.fromArray=function(e){return new r(e[0]||0,e[1]||0)},r.fromObject=function(e){return new r(e.x||0,e.y||0)},r.prototype.addX=function(e){return this.x+=e.x,this},r.prototype.addY=function(e){return this.y+=e.y,this},r.prototype.add=function(e){return this.x+=e.x,this.y+=e.y,this},r.prototype.addScalar=function(e){return this.x+=e,this.y+=e,this},r.prototype.addScalarX=function(e){return this.x+=e,this},r.prototype.addScalarY=function(e){return this.y+=e,this},r.prototype.subtractX=function(e){return this.x-=e.x,this},r.prototype.subtractY=function(e){return this.y-=e.y,this},r.prototype.subtract=function(e){return this.x-=e.x,this.y-=e.y,this},r.prototype.subtractScalar=function(e){return this.x-=e,this.y-=e,this},r.prototype.subtractScalarX=function(e){return this.x-=e,this},r.prototype.subtractScalarY=function(e){return this.y-=e,this},r.prototype.divideX=function(e){return this.x/=e.x,this},r.prototype.divideY=function(e){return this.y/=e.y,this},r.prototype.divide=function(e){return this.x/=e.x,this.y/=e.y,this},r.prototype.divideScalar=function(e){return 0!==e?(this.x/=e,this.y/=e):(this.x=0,this.y=0),this},r.prototype.divideScalarX=function(e){return 0!==e?this.x/=e:this.x=0,this},r.prototype.divideScalarY=function(e){return 0!==e?this.y/=e:this.y=0,this},r.prototype.invertX=function(){return this.x*=-1,this},r.prototype.invertY=function(){return this.y*=-1,this},r.prototype.invert=function(){return this.invertX(),this.invertY(),this},r.prototype.multiplyX=function(e){return this.x*=e.x,this},r.prototype.multiplyY=function(e){return this.y*=e.y,this},r.prototype.multiply=function(e){return this.x*=e.x,this.y*=e.y,this},r.prototype.multiplyScalar=function(e){return this.x*=e,this.y*=e,this},r.prototype.multiplyScalarX=function(e){return this.x*=e,this},r.prototype.multiplyScalarY=function(e){return this.y*=e,this},r.prototype.normalize=function(){var e=this.length();return 0===e?(this.x=1,this.y=0):this.divide(r(e,e)),this},r.prototype.norm=r.prototype.normalize,r.prototype.limit=function(e,t){return Math.abs(this.x)>e&&(this.x*=t),Math.abs(this.y)>e&&(this.y*=t),this},r.prototype.randomize=function(e,t){return this.randomizeX(e,t),this.randomizeY(e,t),this},r.prototype.randomizeX=function(e,t){var r=Math.min(e.x,t.x),o=Math.max(e.x,t.x);return this.x=a(r,o),this},r.prototype.randomizeY=function(e,t){var r=Math.min(e.y,t.y),o=Math.max(e.y,t.y);return this.y=a(r,o),this},r.prototype.randomizeAny=function(e,t){return Math.round(Math.random())?this.randomizeX(e,t):this.randomizeY(e,t),this},r.prototype.unfloat=function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},r.prototype.toFixed=function(e){return void 0===e&&(e=8),this.x=this.x.toFixed(e),this.y=this.y.toFixed(e),this},r.prototype.mixX=function(e,t){return void 0===t&&(t=.5),this.x=(1-t)*this.x+t*e.x,this},r.prototype.mixY=function(e,t){return void 0===t&&(t=.5),this.y=(1-t)*this.y+t*e.y,this},r.prototype.mix=function(e,t){return this.mixX(e,t),this.mixY(e,t),this},r.prototype.clone=function(){return new r(this.x,this.y)},r.prototype.copyX=function(e){return this.x=e.x,this},r.prototype.copyY=function(e){return this.y=e.y,this},r.prototype.copy=function(e){return this.copyX(e),this.copyY(e),this},r.prototype.zero=function(){return this.x=this.y=0,this},r.prototype.dot=function(e){return this.x*e.x+this.y*e.y},r.prototype.cross=function(e){return this.x*e.y-this.y*e.x},r.prototype.projectOnto=function(e){var t=(this.x*e.x+this.y*e.y)/(e.x*e.x+e.y*e.y);return this.x=t*e.x,this.y=t*e.y,this},r.prototype.horizontalAngle=function(){return Math.atan2(this.y,this.x)},r.prototype.horizontalAngleDeg=function(){return o(this.horizontalAngle())},r.prototype.verticalAngle=function(){return Math.atan2(this.x,this.y)},r.prototype.verticalAngleDeg=function(){return o(this.verticalAngle())},r.prototype.angle=r.prototype.horizontalAngle,r.prototype.angleDeg=r.prototype.horizontalAngleDeg,r.prototype.direction=r.prototype.horizontalAngle,r.prototype.rotate=function(e){var t=this.x*Math.cos(e)-this.y*Math.sin(e),r=this.x*Math.sin(e)+this.y*Math.cos(e);return this.x=t,this.y=r,this},r.prototype.rotateDeg=function(e){return e=s(e),this.rotate(e)},r.prototype.rotateTo=function(e){return this.rotate(e-this.angle())},r.prototype.rotateToDeg=function(e){return e=s(e),this.rotateTo(e)},r.prototype.rotateBy=function(e){var t=this.angle()+e;return this.rotate(t)},r.prototype.rotateByDeg=function(e){return e=s(e),this.rotateBy(e)},r.prototype.distanceX=function(e){return this.x-e.x},r.prototype.absDistanceX=function(e){return Math.abs(this.distanceX(e))},r.prototype.distanceY=function(e){return this.y-e.y},r.prototype.absDistanceY=function(e){return Math.abs(this.distanceY(e))},r.prototype.distance=function(e){return Math.sqrt(this.distanceSq(e))},r.prototype.distanceSq=function(e){var t=this.distanceX(e),r=this.distanceY(e);return t*t+r*r},r.prototype.length=function(){return Math.sqrt(this.lengthSq())},r.prototype.lengthSq=function(){return this.x*this.x+this.y*this.y},r.prototype.magnitude=r.prototype.length,r.prototype.isZero=function(){return 0===this.x&&0===this.y},r.prototype.isEqualTo=function(e){return this.x===e.x&&this.y===e.y},r.prototype.toString=function(){return"x:"+this.x+", y:"+this.y},r.prototype.toArray=function(){return[this.x,this.y]},r.prototype.toObject=function(){return{x:this.x,y:this.y}};var n=180/Math.PI},function(e,t){function r(e){var t;return t=2===arguments.length&&"object"==typeof arguments[1]?arguments[1]:o.call(arguments,1),t&&t.hasOwnProperty||(t={}),e.replace(a,function(r,a,o){var s;return"{"===e[o-1]&&"}"===e[o+r.length]?a:(s=t.hasOwnProperty(a)?t[a]:null,null===s||void 0===s?"":s)})}var a=/\{([0-9a-zA-Z]+)\}/g,o=Array.prototype.slice;e.exports=r},function(e,t,r){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),s=r(0),n=function(e){return e&&e.__esModule?e:{default:e}}(s),i=function(){function e(t){a(this,e),this.id=t.id,this._update=t.update,this.parameters=t.parameters&&n.default.clone(t.parameters)||{},this._init=t.init,this.inited=!1}return o(e,[{key:"init",value:function(){this.inited||(this._init&&this._init(),this.inited=!0)}},{key:"update",value:function(e){this._update&&this._update(e)}},{key:"setContext",value:function(e){this.context=e}}]),e}();t.default=i},function(e,t,r){"use strict";var a=r(6),o=function(e){return e&&e.__esModule?e:{default:e}}(a),s=new Phaser.Game(1024,768,Phaser.CANVAS,"main",null,!1,!1);window.game=s,s.state.add("preloading",o.default.preLoading,!0),s.state.add("loading",o.default.loading),s.state.add("battle",o.default.battle),s.state.add("mainMenu",o.default.mainMenu)},function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=r(7),s=a(o),n=r(8),i=a(n),l=r(10),u=a(l),c=r(11),p=a(c);t.default={preLoading:s.default,loading:i.default,mainMenu:u.default,battle:p.default}},function(e,t,r){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),i=function(e){function t(){return a(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s(t,e),n(t,[{key:"preload",value:function(){this.game.stage.backgroundColor=921102,this.game.load.image("loading","./assets/img/loading.png")}},{key:"create",value:function(){this.game.state.start("loading")}}]),t}(Phaser.State);t.default=i},function(e,t,r){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}();console.log(r(9));var i=function(e){function t(){return a(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s(t,e),n(t,[{key:"preload",value:function(){this.game.stage.backgroundColor=921102,this.text=this.add.text(460,250,"LOADING",{fill:"#efefef"}),this.game.load.setPreloadSprite(this.game.add.image(400,300,"loading")),this.game.load.spritesheet("button","./assets/img/buttons.png",293,54),this.game.load.image("mainmenu","./assets/img/mainmenu.jpeg"),this.game.load.image("deathmenu","./assets/img/deathbackground.jpg"),this.game.load.image("bigMonsters","./assets/img/bigMonsters.png"),this.game.load.image("boss","./assets/img/boss.png"),this.game.load.image("bossSpell","./assets/img/bossSpell.png"),this.game.load.image("monsterBlood","./assets/img/sblood.png"),this.game.load.image("bloodEffect","./assets/img/bloods.png"),this.game.load.image("cursor","./assets/img/cursor.png"),this.game.load.image("darkblast","./assets/img/darkblast.png"),this.game.load.image("demons","./assets/img/demons.png"),this.game.load.image("effects","./assets/img/effects.png"),this.game.load.image("explosions","./assets/img/explosions.png"),this.game.load.image("fireball","./assets/img/fireballsprite.png"),this.game.load.image("hellfire","./assets/img/hellfire.png"),this.game.load.image("frostEffect","./assets/img/frosteffect.png"),this.game.load.image("pumpkin","./assets/img/heart.png"),this.game.load.image("hero","./assets/img/mainhero.png"),this.game.load.image("powerUp","./assets/img/powerup2.png"),this.game.load.image("arcaneGate","./assets/img/spell.png"),this.game.load.image("spellIcons","./assets/img/spellicons.png"),this.game.load.image("stone","./assets/img/stones.png"),this.game.load.image("terrain","./assets/img/terrain.png"),this.game.load.image("tree1","./assets/img/tree1.png"),this.game.load.image("tree2","./assets/img/tree2.png"),this.game.load.audio("menuTheme","./assets/music/menu.mp3"),this.game.load.audio("deathTheme","./assets/music/death.mp3"),this.game.load.audio("battleTheme","./assets/music/battle.mp3")}},{key:"create",value:function(){this.text.destroy(),this.game.state.start("mainMenu")}}]),t}(Phaser.State);t.default=i},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAACACAYAAAD03Gy6AAAaa0lEQVR42u1d+5NcxXUekd/CywKDVgOqVGJYaR/S8pCNFAGhbORgG1dRKVWBysAKeYWE8y/wQ6qoFJJYrXZ2V7urFyvAEg+DhJAwhh8ACbHS6rE7+9Jbu5J5GOKkEjuOU0kl1emv7z095/Z037kz0zuzm+RWdc3rTp9zvnO6b9++3+lOpabhsWzJEkHF/G3hggWisbZWNNx+u6iXpUG+X7hgvmiqrxc31XxT1NxysyimvtSMA6CuThkMw1Ea588XAAUA3Dz3JjHnljllAYBzhs5eEBs6OsScdA7MZbJ+yFmxcqUC/9nnnhOfDg6LT4eG1XuUZQ0N6nfUkZ43V/8X71/o7BRD5y4m1qFa9quTByUAGwEAq6xJATBfGVh3+23K4CODQwoEAgDn5ACo0f+dKwFo7eoS2QIAQJ4CP9OhjFH6NDaqekkGCmQcPjGoyicnByPfU4GcubfWaHk1su6NoRNqLCBNB/uVkhC+oT2TA0BGVVN9XQSAh378sDh0/JQsJyUIp5wAoL4IANIoADzXAcAckp8J5AN8qk8ZfGpIyfv+j34oPjp2XJWPB05o+Q21Qct4tq1N64CCloSCVjV07oLTATXpytjvDICaMALXSwXQn9oAgODlP/yB+PDogCoAQQMQRgYpYwUgRgGci3Mg//n2drEsjHz0+XiFsR9Led976K/V564dL+ny3WV/Keq+9RdR+RK85zdvVjrAqagbxRWFcEA17U+RouszUQAaCADp8Y+ODYjvPvT9hADUB/UsaVRGQYGNMQDge/wPOuD1kYcfZvX9OHxtFn/z6ONKJh1nz/9WfX7q6b9VheTj/x98MqBeVb1SNgETGwBVsj8hAE/mA3AhDoBjOQAy8QDU1qUF6YDow/9+dahf1wsZp899reWOjn+hXhc0NqjfLk3+s5i88jux6419+j/vh/J1vfK1tq5WVMP+jQUCIFU7jwGwJADgPQOAMxyA0w4AXo8HIC2Bdl2H4AScN3j2vPof6rjy2R/Epcv/Is5f/EcdcaPjn0cc0NC0SJ3b99pb4vJnvxdXPv+D+PzLP6rvUA/6dtRbGyM7XVcZ++N0KA4AUmChBOCO8gEI5NcqJe9YfJtstu3igeXLIwBQGZOyx05/qeTXLWoUjXc2qXN2vb5XvPTG2/o/+P+GTLus747Y6J8u9hcHwBn/AJAOOH9jRyYq/9U3tfwz577S0dhwR5NYdPed6pyXf/G2eOXNdyLy0fRRX1LZ1ba/qgBw+Rg7c/kvyb6ddEA0ouBYdPdd+pyfv3VA7Nl3MCIf9ZQiv1r2TxsA0HRJvvxaLF66ROmAZg49JmS3gOPO73xby9vz9rvqPzif5KOemRQA0wYAUz6Vu+75thzp7FV9LQ5uLD/Pt/xK2T+tAKB6vv7tf0XqLlT+4Z/+e8YGQNUB4DqQ/Nff+ZU2Nk4ufsfxxsH39bmlyq6m/VUDgM8cYthGdarmLfvWz+TQ7srn/ypsxxe/+Xfx5df/IV575z39H/yfTwsknZKuWgBUEwCSuWnLFn7HqLsB9K+vvPWO6ocnf/17ddPDuwA65zUJFu8SdL3dW+LvRKsdACS0rbs7AQC/Kx6ALd1OAOickQsTqnAdSP6r+38pfr73gHhJDvUw3lY6SEdw+a/Jc9448L6Wz20auTghhmXdhXQw9MzZv+9dNcQk+yeKtL+tu8cdAHTS6MVJMXppUrT19BQG4ErgBK7Aqw4ANgGAC5NOAPB5UwgSn9blOpAeGOphvI1IxB0nl09yuWxeUD/k2OTj92EVAJPqnDz73/6lko0brT5p/4TFfmcASDxHL16W8iftTsAX6qSJywkAeEc54fJnEgBZigEABrbKrsAWBegn6U6Uy+bfcz0+/80fVaHPXG6humwBCL0oQOLsf6UM+8cuXRabJc7WVlAsAOgPMd9RPABp4ZoCoMKAUoU+o565t87RsniprZsbzrfY/2vWb5sHitPZn/21IhUHAP+zDQA8+LYBgGevcQDETQeTou29vaJ961abwlonAuOFzg6RPXchojerPw8E1Iv6Xf0wPzfOhmLtNzF1zgm5otAEIC0jLXh4kVFPeEwA+LlkUGbbNpFhwLqGfrZChmA8nfs+cMKmLV15uv4kHL9z4Cx1Oq+D0BP68tEL6RG8D+ynR4yFAiBJ64sFgCpM/1lT7rt5gRKY5zABWNHSIrp27siro5ACFGEA+mh2XDSvadGgk3wq9JCDCj7z3wkAOAP1oD76T5x8W/ChdO3YEYluCoCc/Wn9G5dfTABoB6x6+mlZ1kY8CeXJSDIE43Uas9NvHKiB0bPq+y07d1JEFrz5wfn9AL9lZR6gzWtWagOvvbFJXHODLLOD1+tubNIBAsBNh6G+/tAJCW+KlN44f2DkbESPPAy6oxgQVhw/4AlcCzqgu69PHB89J7pf7ItUsKIlF2kUAWiKXJgZqT19QR2P57qERHegXTu2a6A1+FJ+5/ZtrBXOVd0PSpssFIH4HefhfK4LrzfhZIDSG+fDDrNl8aAMZKf1d6pVtqyM4Ac8Fa59fQV1iBhPXQr1jUdOjYhrw8iD5w+fyIpPTg6r3wJPr9FCf/rMOt6HFzUNwvt+Ar9/aFRFOuRDn0PHB2UX0Kle8fnasCXgPO4EDlqRHLXAjnU5O1atWaPew17YDfvbJA7AA/KBT2ZbcK1rlriZWCbFIqI4vNkhKz0yOKo+Q9jVs5tUFB4+mVXjWt4/rpYKG3MkJR90XegIjSLn4/3HA6CpnFKv+Ewg8PNLAN2JxerQEaQT7Ib9iH7qCvEbcOrARTx0QNlYoJL+oTFVGfW9EAzP0zNUfhE0IjjlwwGZrb0aXJS0vBdo7exUDsArmGj0G1qBRwekeAsyBwGwHzgAD+ACfBRe2TFfsnNAkBc3h7fpFAU0RHyEDf98gG/KVrf08qJ36PiQ6npwQ5a+tUYVXAsOye6AdCPQPFJmI8NhspVaP8diCmRHFYFw1QJ6uqcMdGckhjc7AJ3J09+Hd9lTrgd3BoDH9eCRIgYbZStAXq+UQJILlvNHA4PiBdkCuAMwHEQLQFBUWqcqYVE9ynyhUvCGZ0YC0NhYFQAWLVggFtUFeQFgPZ8cP6Opi+ZsI+UFqDvU8AaxIBFqugfAwvnzxaIwMQKcxxOFAAhv0be++HLZoxDQzf9+Y6s4mh0WR4dH1XvUSfp09GwVHb25ORviXlJewPD5S2U7ATkBC4uxPwyATToAynACZaL0D0kAsiOadKod0vaceHZzWx4ANR4AqGdU7wfvu1c8eP992lDlFOmQYyNjor07mN08efpsZPIM75EQ0fviruSMNIcOsL+f2b+wgP06AMJnCyUFQP1tDIB7owDgu2MhAKSUFYDzF1VXUCwA199wbUgFzDHR9n/woXIEOQCgUIugYSGlKKEgEaNn566SHRCxHwFwX/H2IwBLsd8NwL33agX6w9ysCACNOQAQfS90dannq8UocMNN3xCPPPBXml1AB6d/kw5KtjwXB2jsfIa0Z2efBP+lgpT0Yuz/3r3LirK/tQT7Swfg8NEIABgutjJ2Q1IFFtXV5cmn92AoTxjPYHFQpHIauPkUKin41ba/IACTUwxAkyEfnPuFd90Z4V/iWSwVnhTxvOyPb1vwLd0HlzIaqbb9TgCaLABcyQNgs7htsQQgHAmUAgAS4ub9+S1aPviXdyy+O8K/fPnN/eLlX+xXr5998W/qwTy+X9++WUeh5dnyjLC/eAC+9AvAjTfPlvJv1fJhKLiYdy+5R8vfvfeAeGD50ghpKuDhZ4zHlhUIAM/2OwD4TsUAwDH7m9dr+eD/LF56j5LnIsByHj51A4mewU5T+6sKAB0wGEccDxM0QC4fFz4f8qeD/ckA+GpqAMCxWMp/RTbxOAIsaIAR+V2dOhWobPlLl1QtAJIDsG/qAOBBwA/0tyDB7tl7MI+NRpkovhxQbAD4lF8QgN1TDAAO9L04fm3wP0GN5PIhexabFnbwdLzYD9tVAOzLtx/zP14dUAwAqSkEAJHI5eMiaOZhwQGKVd3THRl/+5CPoW7U/gNityH/qlkpnYjh3QG4EOUpsNcBQHfuEV25AODCB1km+RVdH5jKXPasWSknqarUycgHli6NCYB3DQfM8h6A8jqwJJJyyRMVXg37P4r+WalUnuCyhCsHLNdA2wqBT8YjB4DT6sudj0f9e/baA+C1/e9Fov9PrrpKUftN+WXpgMp3G32dCQCB36oYYvnNv9znETYSrEn/BvDIaQD1e2zismjv3RpphaXIJQY2+P5x9ivwZQBM2QOZOAACal5XkNUSJnZsDtnHfikhaRVd5FzevUFee29PhMmdYq2x1CCAzLnzakSSAOCsat+tUB3g3IxcuJSX66SE5bJNvBlv4+Rwp/JXk0LvoNiXRIXhMobPX9REXP60i4AHM2JUtkAE4ahKwvAYiBwAMo4bzxUxrwE+OEE2YFOW5IuAEbdNdG7frlhp5UQg1Yt8ArwCVN4CuZ2Ud8DxMFnhZTnBclHNS1pQ/H9ZOkJevW9WAjeECtHX+fyLAmhNi7/mb2mBHAtbICbOiikHAOI9mp4uN/Li5IP4S+RYCoJjI2fU56PDp6P5C57kt96/ULjyBlKOFCjVEmUr7NyxQwbJGj94mNRzGK4SKaThxJn0Nfx0yTc5+or3Lw2EHiYT2QdJyuS6kl3NYRAQJqQDYcHzLLyB37urz2r4CgsF2xcxlx+uHAQCg14NKrgXB6QMyr6tHAuTUZrDJIxU6ZR4uwPAkWeRpftdngmCgpQgKj4dAIo8EiyODo/ndX2rwmDgXcKTjz3mlZqOutDqcd3hgfCff/eswmXV2gD4p9auizjAVyCKJx59NJLtwrNEUix/DP00OcD3RRhJF0ezY/piaLY66LZ6bZBa1bzyMW/yCXzkvZEDeFdoRLvts5dDp+ygb0P+F3KozKapjH96TTG5WEUNhftDB5gy4fCnJPg9fbu8R5+yqaUlLxFQRfy6tWL1M+vEE7LFPbly5dQ4QOVJ7dqlDKRuBuCj39X5VzI6cBEy+mqvBzcKToA8MxfLyEjxJje4yI6rwluByggKHUCyM3Lk5FUH19DL7CMpSlMV4udXQybJbQ5z4WJKxQ7NBDhyarRiYATyRvit/pTLRJoWzxRN/W/OB7C1vmIo4v8PgBfZab1+D6e+m8wz+u7U6XOKHIX3IFiB5TajAyA5AMEq4yfHz+Yo7ABgwQJRruzh8xN6LwC1/nJnh9YBC2MTPRyEKs5cJjo9cgzKHXltChnOxP13BQAY0rR0/qL68uzPAXDBAKCDASCjTQtkSQxHs6OaT18KABRteMhDOQZRQ89pWQMjYxGauOqj779PUcqJswmev7cAcNlflwuAo8Mj0v7h0gNAA9DlAuBsLtoAgIw4DsCDZQJA8tHyaOcJHXGNDXoG1EYVh9z9H3zElhl+Uz29AuW8ePu7Cto/MAX2ewDgQy8AoD60AhCe+KoooILjAImWU8X5Gs/8UAtoy3NBPS/O/i0qx6EY+5FDUK79VQfA1IH3t3xNf3PBPOQOXApXszXp5ZCf9KKcb39Xxe2vKgC20Qco36B+q35XyiaZVyy5AqCSg1IOajmX31Sk/GLtn/Ro/7QAwHzIAeNBAacF+0AN51Rxkg8qOSjlEwwMUM4xUpop9k8rAPjMKyjgfEXzlFrXc6kiS9F3YLSBVAZQcvJvFaCezxT7pwUA5s0N5GMYaMqnklu9cKmilIPRR/JBOS/1Bqwa9k8LAGzyMSDg8kERj5sUwwFAyiEiVMP+5AB8VTkAQHwFBZ7LB0U8blFt8DoXe3RAKQEAqntqygDYVzkAbLtaKB32HlSUcfTL5lGK84uRnygAfDrABsDuKQTAxrWZxZo7yQdlnusESj0O9MU+HYCbs7wA2HdQ5w34sj8WgFQFAYjwLnu6FQ/VdAAA2G2wmBF5U9EC0A2BkBuxf9/BPBo9cgq8OYCAB/ffBkDggKgCdAEq1QG2kQgBgVwArgMo7Jyvz/MYwmxGrwEIOrzZDbsCADkGZc2F2zj/s4yrPnIF9lho7MgtWFzm3Hi0BfTofQUAghkIZoFjQgp9WQEQXYJ+UuUC8FaAXAFbAOxR6azLy3s2YHYDyAHA/IjpBFtB0ywXAIo6cP7B/R8LGcjmBg+uMlUPZJATYHZFZkFuAX5HrkHKBwjg4sN45AKgK0JuAL6fKgCMJ0wR+jtyAjaHjGROkqVNKHws3udqfabMOPuRY1DWql1xIPD8AN5PIpeA7yhdbutzsbN5ggR/9fGgPhJ4Pb0G978nzxH01Cx4hnDRtgx+eQ6w5QCYIPALlQ9eEGdcg/PfwZaUL8RQLsdwGxWe24tcACxdbMNFtUDpJJ5bUHZuQG754G06D8C1yYFvdrSN888XzuZcTS/JECn3TiJxgWeOGL3SVmzcf3O/AJ8AxF0IwUYjGjj4mtz5IOmCm+rDAbADzD9w/MH1d6yA4tyoAe9bA4acPwdQxUTJIyoigDCp3L5JURHuaZgZQ9RIM2fAZ/fH1/znNkM2B58czx3EdCsfALNSinwbEMgl8E3MjToglxPgWtffZ8vTLUw6A7xYEJPjcgXMHIayFTE4/5FdNThFnYSy9fa9gMC4/jo3YRXLUtHRmR1XFPYVwb4B3gKPXmn5elDgbY5HKxgIU6ZSvniiRP1GoWZGgs2sFaKvI5cg5ZMaHnL9V69bq2XktcaQut4pBwgeW18s7593fdQ1giXOnOAHgJ+wiDObGmjqaJLUVz7ufwVxbTBR5MnxXBflgKExnwniVgc0y/rRIn/6zDO6RZibCzXnNm7wOwqhRDTsKESCA6/v1N3QKiRJSKCmYu1+s0/moKd85mRZZHf8YGEu/Um2yNXPrIsMSAA65Q/4Tk7RitjG/ikjV6BCK5e7dJnKw/nUq9nXViVJjMb+KMQQSFWPH6+3Tvn4+FC11+6P7J50ZGh05ucNxNG84yjhNbfMUSTaYuqbmQBg6XaUhgbFlaSl3OdKAEDhLgcA13wSn+xrqq9X5Kjjo+OynA6Yam1tSg++jLxtYi2pDokCQNlNhewvMwCiAKSjAISrk4OKHvDwc9RwlGUNOQBqSwAA+Qe05DsBSIqvD6ngxMME/79/aETnAdD3yBkgCjltNxjokNb7CcdND8faHzoYFEOyf2Bk3BoA/L+JA6BWAXDJCgBR8sjQT4eGxaeDw5oZrAGQ5+UAqLUDYGklygHye7Xke1eXXv9ZLxkvDYSxoIIr+VL2kVNZ+ZqNyMd5G6QTonM3wU53mDLGc4xY+Y4AyLN/MIn9tgCYVIkudgckAAARFyTIDYlPTg4pEEwA1mcy8QA4FCBKOOSbs5BafugAyIMOVvmGA6gu2vvSFYXpeWmn/c/n2Z8t2X6nAygrJRaALAPApsBzpQNgspFfCBdIou9JTi4KsyoKc7KfszpgE9v3LK4bcAaA7FoS218oACzbqU8bAMyHG62GfK6DTR9awdwMHrA5LA+Tpp39VQeAX7D4AoBceboQ04VQDwDkyAiyyXgzAmktu0Kyq22/BwAyJQNgA8GUr+tm+8XQrka27EVeR5KHRdUMgGkBgPkAyCbbBowrfbTYFWyng/1VBcAEIa6YD8N9y6+W/dMGgP+r8mdEBMbJj9ticEY5oNoAOPvfmAm5SsifavurDoBNBz0nJEcZGG08375ZzfusDwtytzZ0dKgMFt+yq2F/YQDC4hsAlzEbOjJadqGuwTYMLHZKumoBUE0AeHY6/YcvFaCmf+V4W63EEm5xaw4FI3s5XpzQt/5mvUXbn6lAABQDAO0oGguAYlAnAyD3n0uq0HwMfY8ZxsEz59V2sngOECySEUwH45kAvj915pzaxJM20eT/xzxMUPdEQR24bEQ06swLgAT2jxgBwG/unODjTwFwW/IAgIEBAKfDVVLsANAuqvz/rQUAoMVB6HdXJPFpYThhQDoDCdDqwZCFy2nWxYPCHgATekbUbf94rP3DFvshE9iiWJ1Acxa0Tn8SAEgBRIR6OpYAAB4VdvZF2rH4dTrcszej1+k5MSYNHztjle0i2AZTw7XW6IdeBFDiAJD2NxVhv9plw2Z/3iLcDmPQF5IS9EhwWUO9XjXLBUChnSXMDBQXIYqicUMmuPgNyqgzDS1EXXddFG0YmAEQ2N8W2n+a2Z80ABwYuE62AYALshoFSEWweBEH3wTAdiFyRaBaBn/rVlnseQC2G6TWrk7X7qV5IKBe1O/qh10jn1xdwVMtCsIk9tv0do6KXMu0xwGwIZOJBUAnWOzYHqF5F4pAc2lk1+4Yru9Ih6R7O0Y3gdgebgLhsKcI+13U9cSUcFcFtIBd9LGbncaeNHuFk3271Mq8T0cIsGbd14WFUyVNGbTCeteOnSaZ2Op8WwDm151W7IdC9vP/l8oVcma/XDO7SVz9jSbxp9fLIl+vuaHJChIHpxBvlCjntDS+i3HnWkre1mo5cYrqLhCBmgCcjnHu1bND268PcLj2hiZnLlvK1/rReZkxsskdOj4kRw9bxCcnh/OM58qDzJokbcfRTSgOKroxzoa+ziDnEmhdO4JVzrmsIiiTEX1tNHSUwyezaqh+KGTmlb2FbSFQYFT/0DgTlg4dkJXDqsAB9BuY0k88+rBmE6/52c/KyZkKCMAS/P7seARwPBBv7+lWr3xFdRBkcf4qwwnF0g1bpN7NIe0R9hADHLJgb5tyQDbigIAwPK4JzN4cgIsSRhBoykFzSyt+DaIA0cAzAtGEjYgvuRkGzOOVKvFC9/03NoUgZHVRDrgx1+LIAWWAEOnCYA/PTYC9h08ErQA4AA/gAnyAE/Dy6gC+aLVqglL4Yel9CKa8Wccy8uXLDh1AEQ4HQG7Q8rJS/hYlj3dJcEDzmhavOymZ1HjYDT2AA/DgIzfPeQrRPpQAN0FngHtfv59kYMX0I6eGpQ7duisMIrJHRl6vTSff9PRI0kg0obunIvT8XB/Y3SP74N5KrpkfyYo3AangUvbaIbAfONA1sBKyFcWCexoJ3JUyGlFOkc4dgH6XMukrpUtHmI+me4be3qJl/w/LjcXNbe51yQAAAABJRU5ErkJggg=="},function(e,t,r){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),i=function(e){function t(){return a(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s(t,e),n(t,[{key:"init",value:function(){this.menuTheme=this.sound.add("menuTheme",.3,!0),this.background=this.game.add.image(512,768,"mainmenu"),this.background.anchor.set(.5,1),this.background.alpha=.8}},{key:"create",value:function(){this.generateControls(),this.menuTheme.play()}},{key:"generateControls",value:function(){var e=this.add.button(512,384,"button",this.startGame,this,2,0,1,2),t=this.add.text(0,3,"START",{fill:"#efefef"}),r=this.add.text(-300,-300," MOVING: WASD\n AIM: MOUSE\n CAST SPELL: MOUSE CLICK OR SPACE\n SELECT SPELL: 1, 2, 3.",{fontSize:"20px",fill:"#efefef"});t.anchor.setTo(.5,.5),r.anchor.setTo(.5,.5),e.anchor.setTo(.5,.5),e.addChild(t),e.addChild(r)}},{key:"startGame",value:function(){this.game.state.start("battle")}},{key:"shutdown",value:function(){this.menuTheme.stop()}}]),t}(Phaser.State);t.default=i},function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),l=r(12),u=a(l),c=r(13),p=a(c),d=function(e){function t(){return o(this,t),s(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return n(t,e),i(t,[{key:"init",value:function(){this.battleTheme=this.sound.add("battleTheme",.3,!0),this.deathTheme=this.sound.add("deathTheme",.3,!0)}},{key:"create",value:function(){this.pauseFlag=!1,this.collisions=(0,u.default)({n:6,width:1500,height:1200}),this.initGameParameters(),this.initGameLayer(),this.initControls(),this.battleTheme.play()}},{key:"initControls",value:function(){this.restartButton=this.add.button(512,384,"button",this.restart,this,2,0,1,2),this.restartButton.addChild(this.add.text(-65,-15,"RESTART",{fill:"#efefef"})),this.restartButton.addChild(this.add.text(-70,-70,"YOU DIED!",{fill:"#EF0000"})),this.restartButton.anchor.setTo(.5,.5),this.restartButton.kill()}},{key:"initGameParameters",value:function(){this.parameters={},this.parameters.bestTime=localStorage.getItem("bestTime")||0,this.parameters.bestScore=localStorage.getItem("bestScore")||0}},{key:"initGameLayer",value:function(){this.bitmap=this.add.bitmapData(this.game.canvas.width,this.game.canvas.height,"battleBitmap"),this.image=this.add.image(0,0,this.bitmap);var e={id:"mainLayer",size:[1324,1068],background:"terrain",initList:["player","cursor","counter","timer","bestTime","fireballSpell","hellfireSpell","frostShardSpell","teleportSpell","bestScore","level","fog","monsterController"],init:function(){this.state.parameters.monstersKilled=0,this.state.parameters.gameTimer=0},translate:{x:-150,y:-150},state:this,ctx:this.bitmap.ctx,rules:["random_trees","spawn_heart","spawn_powerup","goWithPlayer"]};this.gameLayer=new p.default(e),this.gameLayer.init()}},{key:"stopBattle",value:function(){this.processGameParameters(),this.battleTheme.stop(),this.deathTheme.play(),this.restartButton.revive(),this.pauseFlag=!0}},{key:"processGameParameters",value:function(){this.parameters.gameTimer>this.parameters.bestTime&&(this.parameters.bestTime=this.parameters.gameTimer,localStorage.setItem("bestTime",this.parameters.bestTime)),this.parameters.monstersKilled>this.parameters.bestScore&&(this.parameters.bestScore=this.parameters.monstersKilled,localStorage.setItem("bestScore",this.parameters.bestScore))}},{key:"prepareForRender",value:function(){!0===this.pauseFlag?(this.gameLayer.render(0),this.bitmap.rect(0,0,this.game.canvas.width,this.game.canvas.height,"rgba(10,0,0,0.5)")):(this.gameLayer.update(this.game.time.physicsElapsed),this.gameLayer.render(this.game.time.physicsElapsed))}},{key:"restart",value:function(){this.pauseFlag=!1,this.battleTheme.play(),this.deathTheme.stop(),this.collisions.clear(),this.restartButton.kill(),this.gameLayer.clearLayer(),this.gameLayer.init()}},{key:"update",value:function(){this.prepareForRender()}}]),t}(Phaser.State);t.default=d},function(e,t,r){"use strict";function a(e){function t(){for(var e=0;e<h.length;e++)h[e]=[]}function r(e){return e[0]+e[1]*d}function a(e){for(var t=e.getParameter("collisions").cells,r=0;r<t.length;r++)h[t[r]]&&h[t[r]].splice(h[t[r]].indexOf(e),1)}function o(e){for(var t=e.pos,a=e.size,o=[],s=a[0]>>l,n=a[1]>>l,i=0;i<2+s;i++)for(var u=0;u<2+n;u++)o.push(r([t.x-a[0]/2+i*(a[0]/(1+s))>>l,t.y-a[1]/2+u*(a[1]/(1+n))>>l]));return o}function s(e){for(var t=o(e),r=e.getParameter("collisions").cells,a=0;a<t.length;a++)r[a]!=t[a]?(h[r[a]]&&h[r[a]].splice(h[r[a]].indexOf(e),1),h[t[a]]&&-1==h[t[a]].indexOf(e)&&h[t[a]].push(e),r[a]=t[a]):h[t[a]]&&-1==h[t[a]].indexOf(e)&&h[t[a]].push(e)}function n(){for(var e=0;e<=p;e++)for(var t=0;t<=d;t++)if(h[r([e,t])])for(var a=h[r([e,t])],o=a.length,s=0;s<o;s++)for(var n=s+1;n<o;n++)i(a[s].pos,a[s].size,a[n].pos,a[n].size)&&(-1==a[s].getParameter("collisions").indexOf(a[n])&&a[s].getParameter("collisions").push(a[n]),-1==a[n].getParameter("collisions").indexOf(a[s])&&a[n].getParameter("collisions").push(a[s]))}function i(e,t,r,a){return function(e,t,r,a,o,s,n,i){return!(r>=o||e<n||a>=s||t<i)}(e.x+t[0]/2,e.y+t[1]/2,e.x-t[0]/2,e.y-t[1]/2,r.x+a[0]/2,r.y+a[1]/2,r.x-a[0]/2,r.y-a[1]/2)}var l=e.n||6,u=e.width||800,c=e.height||600,p=u>>l,d=c>>l,h=new Array(p*d);return t(),{cellGrid:h,updateObject:s,removeObject:a,check:n,clear:t}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=a},function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),n=r(0),i=a(n),l=r(1),u=a(l),c=r(28),p=a(c),d=r(4),h=a(d),f=function(){function e(t){o(this,e),this.objectCount=0,this.id=t.id,this.state=t.state,this.game=this.state.game,this.ctx=t.ctx,this.initList=t.initList,this.background=this.ctx.createPattern(this.game.cache.getImage(t.background),"repeat"),this.pos=t.pos?new Phaser.Point(t.pos[0],t.pos[1]):new Phaser.Point(0,0),this.size=t.size||[t.ctx.canvas.width,t.ctx.canvas.height],this.defaultTranslate=t.translate||{x:0,y:0},this.sortedObjects={default:[]},this.objects={},this._rules=t.rules||[],this._init=t.init,this.inited=!1}return s(e,[{key:"init",value:function(){if(!this.inited){this.translate=i.default.clone(this.defaultTranslate);for(var e=0;e<this.initList.length;e++)this.addObject(u.default.getConfig(this.initList[e]));this._init&&this._init();var t=this._rules;this.rules=[];for(var r=0,a=t.length;r<a;r++)this.addRule(u.default.getRuleConfig(t[r]));this.inited=!0}}},{key:"render",value:function(e){if(this.inited){var t={},r=this.ctx;r.save(),r.beginPath(),r.rect(this.pos.x,this.pos.y,this.size[0],this.size[1]),r.clip(),r.translate(this.translate.x,this.translate.y),r.fillStyle=this.background,r.fillRect(0,0,this.size[0]+5,this.size[1]+5);for(var a in this.objects)this.objects.hasOwnProperty(a)&&(t[this.objects[a].zIndex]||(t[this.objects[a].zIndex]=[]),t[this.objects[a].zIndex].push(this.objects[a]));for(var o in t)if(t[o])for(var s=0,n=t[o].length;s<n;s++)r.save(),r.translate(Math.round(t[o][s].pos.x),Math.round(t[o][s].pos.y)),t[o][s].render(e),r.restore();r.translate(-this.translate.x,-this.translate.y),r.restore()}}},{key:"update",value:function(e){if(this.inited){for(var t in this.rules)this.rules.hasOwnProperty(t)&&this.rules[t].update(e);for(var r in this.objects)this.objects[r].update(e);for(var a in this.objects)this.objects[a].updateCollisions(e);this.state.collisions.check();for(var o in this.objects)this.objects[o].updateConditions(e);for(var s in this.objects)this.objects[s]._removeInNextTick&&(this.objects[s].collisions&&this.state.collisions.removeObject(this.objects[s]),this.removeObject(this.objects[s].id))}}},{key:"addRule",value:function(e){var t=new h.default(e);t.setContext(this),t.init(),this.rules.push(t)}},{key:"removeObject",value:function(e){this.objects.hasOwnProperty(e)&&(this.objects[e].layer=null,this.objects[e].type&&"default"!=this.objects[e].type?this.sortedObjects[this.objects[e].type].splice(this.sortedObjects[this.objects[e].type].indexOf(e),1):this.sortedObjects.default.splice(this.sortedObjects.default.indexOf(e),1),this.objects[e]=null,delete this.objects[e])}},{key:"addObject",value:function(e){if(this.objects.hasOwnProperty(e.id))return console.error("Object with such id already exist in this layer: ",e.id),!1;e.layer=this,e.id+=this.objectCount+++Math.round((new Date).getTime()+1000001*Math.random());var t=new p.default(e);return t.init(),e.type&&"default"!=e.type?(!this.sortedObjects[e.type]&&(this.sortedObjects[e.type]=[]),this.sortedObjects[e.type].push(t.id)):this.sortedObjects.default.push(t.id),this.objects[t.id]=t,this.objects[t.id]}},{key:"getObjectsByType",value:function(e){for(var t=this.sortedObjects[e]||[],r=[],a=0,o=t.length;a<o;a++)r.push(this.objects[t[a]]);return r}},{key:"clearLayer",value:function(){this.objects=[],this.sortedObjects={default:[]},this.rules=[],this.inited=!1}}]),e}();t.default=f},function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=r(15),s=a(o),n=r(16),i=a(n),l=r(17),u=a(l),c=r(18),p=a(c),d=r(19),h=a(d),f=r(20),m=a(f),y={};Object.assign(y,i.default),Object.assign(y,s.default),Object.assign(y,u.default),Object.assign(y,p.default),Object.assign(y,m.default),Object.assign(y,h.default),t.default=y},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={fireballSpell:{zIndex:5e3,sprite:["spellIcons",[0,0],[32,32]],pos:[449,748],size:[32,32],render:"spell",parameters:{bulletsFired:0,cooldown:20},type:"spell",rules:["fireball"]},hellfireSpell:{zIndex:5e3,sprite:["spellIcons",[96,0],[32,32]],pos:[491,748],size:[32,32],render:"spell",parameters:{bulletsFired:0,cooldown:800},type:"spell",rules:["hellfire"]},frostShardSpell:{zIndex:5e3,sprite:["spellIcons",[224,96],[32,32]],pos:[533,748],size:[32,32],render:"spell",parameters:{shardsFired:0,cooldown:500},type:"spell",rules:["frostShard"]},teleportSpell:{zIndex:5e3,sprite:["spellIcons",[64,32],[32,32]],pos:[575,748],size:[32,32],render:"spell",parameters:{power:200,teleportGates:0,cooldown:200},type:"spell",rules:["teleport"]},teleportGate:{zIndex:0,render:"object",sprite:["arcaneGate",[0,0],[32,32],7,[0,1]],pos:[466,580],size:[32,32],parameters:{cooldown:200},type:"spellElement",rules:["removeOnCooldown","dynamicZIndex"]},bullet:{zIndex:3,collisions:!0,render:"object",sprite:["fireball",[0,0],[33,33],16,[0,1,2,3]],size:[25,25],type:"spellElement",parameters:{power:10,cooldown:100,speed:300},conditions:["bulletMonsterCollision"],rules:["destroyAfterLeavingLayer","moveToDirection","dynamicZIndex","explosionOnCooldown"]},hellfireTube:{zIndex:3,collisions:!0,render:"object",sprite:["hellfire",[0,0],[21,58],14,[0,1,2,3,4,4,3,3,4,4,3,3,4,4],null,!0],size:[50,50],type:"spellElement",parameters:{power:10,cooldown:25,speed:300},conditions:["hellTubeMonsterCollision"],rules:["dynamicZIndex","explosionAfterSpriteDone"]},frostShard:{zIndex:3,render:"object",collisions:!0,sprite:["effects",[96,0],[32,32],10,[0,1,2]],type:"spellElement",size:[500,500],parameters:{power:60,cooldown:200},conditions:["slowEnemies"],rules:["removeOnCooldown","dynamicZIndex"]}};t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={monsterController:{render:!1,collisions:!1,type:"monsterController",rules:["monsterController"],parameters:{monsterCount:[10,25,50,75,100,150,200,500,1e3,2500,5e3,1e4],monsterCooldown:7}}};t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={player:{zIndex:20,sprite:["hero",[0,0],[32,32],6,[0,1,2]],pos:[662,534],size:[25,32],render:"unit",collisions:!0,parameters:{speed:150,health:50,spellPower:1,level:1,exp:0,effects:[],currentSpell:"fireball",direction:{},levelTable:{1:600,2:1200,3:2e3,4:3e3,5:4500,6:6500,7:9e3,8:13e3,9:2e4}},type:"player",conditions:["selectSpellWithKeyboard"],rules:["moveWithKeyboard","rotateToMouse","bindPositionToLayer","playerDeath","moveToDirection","dynamicZIndex","resetSpeed","resetEffects","playerLevelUp"]},summonGate:{zIndex:0,render:"object",sprite:["arcaneGate",[0,0],[32,32],7,[0,1]],pos:[466,580],size:[25,30],collisions:!0,parameters:{cooldown:80,exp:3,chanceOfBoss:5,chanceOfBoss2:8,chanceOfBoomer:20,health:10},conditions:["monsterHealthStatus"],type:"monster",rules:["summonOnCooldown","dynamicZIndex"]},monster:{zIndex:1,sprite:["demons",[0,128],[32,32],6,[0,1,2]],size:[20,28],collisions:!0,render:"unit",parameters:{speed:25,cooldown:70,scentSpeed:120,scentRange:600,exp:15,wanderCooldown:500,effects:[],health:20,power:5},conditions:["monsterHealthStatus","stopOnCollisionWithPlayer"],type:"monster",rules:["moveToDirection","wandererAI","rotateByDirection","meleeAttack","dynamicZIndex","resetEffects","resetMeleeCooldown"]},monsterBoomer:{zIndex:1,sprite:["demons",[96,128],[32,32],6,[0,1,2]],size:[20,28],collisions:!0,render:"unit",parameters:{speed:100,exp:30,effects:[],health:10,power:10},conditions:["monsterHealthStatus","monsterExplosionCondition"],type:"monster",rules:["moveToDirection","rotateByPlayer","setDirectionToPlayerAdvance","dynamicZIndex","resetSpeed","resetEffects"]},monsterBoss:{zIndex:1,collisions:!0,sprite:["bigMonsters",[0,0],[32,50],6,[0,1,2]],size:[25,40],render:"unit",parameters:{speed:50,exp:60,cooldown:75,power:10,health:50,effects:[]},conditions:["monsterHealthStatus","stopOnCollisionWithPlayer"],type:"monster",rules:["setDirectionToPlayer","monsterBossLogic","moveToDirection","rotateByDirection","dynamicZIndex","resetSpeed","resetEffects","resetRangeCooldown"]},monsterBoss2:{zIndex:1,collisions:!0,sprite:["boss",[0,0],[96,48],6,[0,1,2]],size:[40,45],render:"unit",parameters:{speed:15,cooldown:200,exp:120,fireRange:300,power:10,health:30,effects:[]},conditions:["monsterHealthStatus","stopOnCollisionWithPlayer"],type:"monster",rules:["setDirectionToPlayer","monsterBoss2Logic","rotateByDirection","dynamicZIndex","resetSpeed","resetEffects","resetRangeCooldown"]},heart:{zIndex:3,render:"object",collisions:!0,size:[25,25],sprite:["pumpkin",[0,0],[32,32],5,[0,1]],conditions:["triggerOnPlayerCollision"],rules:["dynamicZIndex"],parameters:{power:10}},powerup:{zIndex:2,size:[25,25],collisions:!0,sprite:["powerUp",[0,0],[72,65],15,[0,1,2,1]],conditions:["triggerOnPlayerCollisionPowerUp"],parameters:{exp:250}}};t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={mbullet:{zIndex:3,collisions:!0,sprite:["darkblast",[0,0],[38,38],12,[0,1,2,3]],type:"monsterSpellElement",render:"object",size:[32,32],conditions:["damageOnPlayerCollision","destroyOnPlayerCollision"],parameters:{power:8,speed:100},rules:["destroyAfterLeavingLayer","moveToDirection","dynamicZIndex"]},mbullet2:{zIndex:3,collisions:!0,sprite:["bossSpell",[0,0],[30,26],10,[0,1,2]],type:"monsterSpellElement",render:"object",size:[28,24],conditions:["monsterBoss2Bullet"],parameters:{power:15,cooldown:100,speed:200},rules:["destroyAfterLeavingLayer","setDirectionToPlayer","rotateByDirection","moveToDirection","dynamicZIndex"]},blood:{zIndex:2,sprite:["monsterBlood",[0,0],[32,13]],parameters:{cooldown:500},rules:["removeOnCooldown"]},bloodSpray:{zIndex:2,sprite:["bloodEffect",[0,0],[64,64],15,[0,1,2,3,4],null,!0,.785],rules:["destroyAfterSpriteDone","dynamicZIndex"]},explosion:{render:"object",size:[39,39],sprite:["explosions",[0,0],[39,39],16,[0,1,2,3,4,5,6,7,8,9,10],null,!0],rules:["destroyAfterSpriteDone","dynamicZIndex"]},monsterExplosion:{render:"object",collisions:!0,type:"spellEffect",conditions:["monsterExplosion"],size:[39,39],sprite:["explosions",[0,0],[39,39],16,[0,1,2,3,4,5,6,7,8,9,10,11,12],null,!0],rules:["destroyAfterSpriteDone","dynamicZIndex"]},fog:{render:"fog",zIndex:2500,type:"effect"}};t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={tree1:{sprite:["tree1",[0,0],[62,87]],size:[62,88],rules:["dynamicZIndex"]},tree2:{sprite:["tree2",[0,0],[59,87]],size:[60,88],rules:["dynamicZIndex"]},stones:{render:"object",sprite:["stone",[0,0],[25,22]],size:[15,22],rules:["dynamicZIndex"]}};t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={cursor:{zIndex:3e3,render:"ui",pos:[400,350],sprite:["cursor",[0,0],[30,30]],rules:["bindPositionToMouse"]},counter:{zIndex:3e3,pos:[5,13],render:"text",parameters:{weight:"bold",color:"#DAA520",template:"SCORE: {kills}",size:14},rules:["countMonsterKilled"]},leftOnWaveLabel:{zIndex:3e3,pos:[5,100],render:"text",parameters:{weight:"bold",color:"#DAA520",template:"LEFT ON THIS WAVE: {count}",size:14}},level:{zIndex:3e3,pos:[35,45],render:"expBar",parameters:{weight:"bold",color:"#EFEFEF",template:"LEVEL: {level}",size:14},rules:["level"]},timer:{zIndex:3e3,pos:[5,23],render:"text",parameters:{weight:"bold",color:"#DAA520",template:"TIMER: {time}",size:14},rules:["timer"]},bestTime:{pos:[5,370],zIndex:3e3,render:"text",parameters:{weight:"bold",color:"#DAA520",size:14,template:"BEST TIME: {time}"},rules:["bestTime"]},bestScore:{pos:[5,380],zIndex:3e3,render:"text",parameters:{weight:"bold",color:"#DAA520",size:14,template:"BEST SCORE: {score}"},rules:["bestScore"]}};t.default=a},function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=r(22),s=a(o),n=r(23),i=a(n),l=r(24),u=a(l),c=r(25),p=a(c),d=r(26),h=a(d),f=r(27),m=a(f),y={};Object.assign(y,i.default),Object.assign(y,s.default),Object.assign(y,u.default),Object.assign(y,p.default),Object.assign(y,h.default),Object.assign(y,m.default),t.default=y},function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=r(0),s=a(o),n=r(1),i=a(n),l={fireball:{update:function(){var e=this.context,t=e.layer.getObjectsByType("player")[0],r=e.getParameter("fireCooldown");if("fireball"==t.getParameter("currentSpell")&&(e.layer.game.input.mousePointer.isDown||e.layer.game.input.keyboard.isDown(32))&&!r){var a=new Phaser.Point(e.layer.game.input.mousePointer.x,e.layer.game.input.mousePointer.y),o=t.getParameter("spellPower"),s=10*(o-1);a.x-=e.layer.translate.x,a.y-=e.layer.translate.y;for(var n=0;n<o;n++){var l=a.clone().rotate(t.pos.x,t.pos.y,s,!0);!function(r,a){var s=i.default.getConfig("bullet");s.pos=t.pos.clone();var n=e.layer.addObject(s);n.setParameter("direction",r),n.setParameter("power",n.getParameter("power")+5*(o-1)),n.sprite.setDegree(t.pos.angle(a))}(Phaser.Point.subtract(l,t.pos),l.clone()),s-=20}e.setParameter("cooldown",e.getDefaultParameter("cooldown")),e.setParameter("fireCooldown",e.getParameter("cooldown"))}r&&e.setParameter("fireCooldown",r-1)}},hellfire:{update:function(){var e=this.context,t=e.layer.getObjectsByType("player")[0],r=e.getParameter("fireCooldown");if("hellfire"==t.getParameter("currentSpell")&&(e.layer.game.input.mousePointer.isDown||e.layer.game.input.keyboard.isDown(32))&&!r){for(var a=new Phaser.Point(0,1),o=s.default.moveWithSpeed(t.pos,a,100),n=t.getParameter("spellPower"),l=-10;l<10;l++){var u=o.clone().rotate(t.pos.x,t.pos.y,18*l,!0);!function(t){var r=i.default.getConfig("hellfireTube");r.pos=t;var a=e.layer.addObject(r);a.setParameter("power",a.getParameter("power")+5*(n-1))}(u)}e.setParameter("cooldown",e.getDefaultParameter("cooldown")),e.setParameter("fireCooldown",e.getParameter("cooldown"))}r&&e.setParameter("fireCooldown",r-1)}},slowEnemies:{update:function(){for(var e=this.context,t=e.getParameter("collisions"),r=0;r<t.length;r++)if("monster"==t[r].type){var a=t[r].getParameter("speed"),o=e.getParameter("power"),s=t[r].getParameter("effects")||[];a<o?t[r].setParameter("speed",0):t[r].setParameter("speed",a-o),-1==s.indexOf("frozen")&&s.push("frozen")}}},teleport:{update:function(){var e=this.context,t=e.layer.getObjectsByType("player")[0],r=e.getParameter("fireCooldown");if("teleport"==t.getParameter("currentSpell")&&(e.layer.game.input.mousePointer.isDown||e.layer.game.input.keyboard.isDown(32))&&!r){var a=new Phaser.Point(e.layer.game.input.mousePointer.x,e.layer.game.input.mousePointer.y);a.x-=e.layer.translate.x,a.y-=e.layer.translate.y;var o,n=Phaser.Point.subtract(a,t.pos),l=t.getParameter("spellPower"),u=s.default.moveWithSpeed(t.pos,n,e.getParameter("power")),c=e.getDefaultParameter("cooldown",c)-30*(l-1);o=i.default.getConfig("teleportGate"),o.pos=t.pos.clone(),e.layer.addObject(o),o=i.default.getConfig("teleportGate"),o.pos=u.clone(),e.layer.addObject(o),t.setPosition(u),e.setParameter("cooldown",c>50?c:50),e.setParameter("fireCooldown",e.getParameter("cooldown"))}r&&e.setParameter("fireCooldown",r-1)}},frostShard:{update:function(){var e=this.context,t=e.layer.getObjectsByType("player")[0],r=e.getParameter("fireCooldown");if("frostShard"==t.getParameter("currentSpell")&&(e.layer.game.input.mousePointer.isDown||e.layer.game.input.keyboard.isDown(32))&&!r){var a=i.default.getConfig("frostShard"),o=new Phaser.Point(e.layer.game.input.mousePointer.x,e.layer.game.input.mousePointer.y),s=t.getParameter("spellPower"),n=o.clone();n.x-=e.layer.translate.x,n.y-=e.layer.translate.y,a.pos=n.clone();for(var l=0,u=1;u<s;u++)l+=50;var c=e.layer.addObject(a);c.setParameter("cooldown",c.getParameter("cooldown")+l),e.setParameter("fireCooldown",e.getParameter("cooldown"))}r&&e.setParameter("fireCooldown",r-1)}},bulletMonsterCollision:{update:function(){for(var e=this.context,t=e.getParameter("collisions"),r=0,a=t.length;r<a;r++)if("monster"==t[r].type){t[r].setParameter("health",t[r].getParameter("health")-e.getParameter("power"));var o=i.default.getConfig("bloodSpray");o.pos=t[r].pos.clone(),o.pos.x+=2,o.pos.y+=-10,e.layer.addObject(o),e._removeInNextTick=!0;break}}},hellTubeMonsterCollision:{update:function(){for(var e=this.context,t=e.getParameter("collisions"),r=0,a=t.length;r<a;r++)if("monster"==t[r].type){t[r].setParameter("health",t[r].getParameter("health")-e.getParameter("power"));var o=i.default.getConfig("bloodSpray");o.pos=t[r].pos.clone(),o.pos.x+=2,o.pos.y+=-10,e.layer.addObject(o);break}}}};t.default=l},function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=r(3),s=a(o),n=r(1),i=a(n),l=r(2),u={monsterController:{init:function(){var e=this.context;e.setParameter("currentWave",1),e.setParameter("monsterOnWave",this.parameters.monsterCount[e.getParameter("currentWave")-1]),e.setParameter("monsterKilled",0),e.setParameter("monsterSpawned",0),this.leftOnWave=this.context.layer.addObject(i.default.getConfig("leftOnWaveLabel"))},update:function(){var e=this.context;e.getParameter("monsterSpawned")<e.getParameter("monsterOnWave")?this.parameters.currentMonsterCooldown?this.parameters.currentMonsterCooldown&&this.parameters.currentMonsterCooldown--:(!function(){var t=new l(100-e.layer.translate.x,100-e.layer.translate.y),r=new l(900-e.layer.translate.x,650-e.layer.translate.y),a=i.default.getConfig("summonGate"),o=l(10,20).randomize(t,r).toArray();a.pos=new Phaser.Point(o[0],o[1]),a.pos.x=Math.min(1100,Math.max(50,a.pos.x)),a.pos.y=Math.min(900,Math.max(50,a.pos.y)),e.layer.addObject(a)}(),e.setParameter("monsterSpawned",e.getParameter("monsterSpawned")+1),this.parameters.currentMonsterCooldown=this.parameters.monsterCooldown):e.getParameter("monsterKilled")>=e.getParameter("monsterOnWave")&&(e.setParameter("currentWave",e.getParameter("currentWave")+1),e.setParameter("monsterSpawned",0),e.setParameter("monsterOnWave",this.parameters.monsterCount[e.getParameter("currentWave")-1]),e.setParameter("monsterKilled",0)),this.leftOnWave.setParameter("text",(0,s.default)(this.leftOnWave.getParameter("template"),{count:e.getParameter("monsterKilled")+"/"+e.getParameter("monsterOnWave")}))},parameters:{monsterCount:[10,25,50,75,100,150,200,500,1e3,2500,5e3,1e4],monsterCooldown:10}}};t.default=u},function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=r(0),s=a(o),n=r(1),i=a(n),l={playerDeath:{update:function(){var e=this.context;e.getParameter("health")<=0&&e.layer.state.stopBattle()}},damageOnPlayerCollision:{update:function(){for(var e=this.context,t=e.getParameter("collisions"),r=0;r<t.length;r++)if("player"==t[r].type){t[r].setParameter("health",t[r].getParameter("health")-e.getParameter("power"));break}}},destroyOnPlayerCollision:{update:function(){for(var e=this.context,t=e.getParameter("collisions"),r=0;r<t.length;r++)if("player"==t[r].type){var a=i.default.getConfig("explosion");a.pos=e.pos.clone(),e.layer.addObject(a),e._removeInNextTick=!0;break}}},triggerOnPlayerCollision:{update:function(){for(var e=this.context,t=e.getParameter("collisions"),r=0;r<t.length;r++)if("player"==t[r].type){t[r].getParameter("health")<t[r].getDefaultParameter("health")&&(t[r].getParameter("health")+e.getParameter("power")<=t[r].getDefaultParameter("health")?t[r].setParameter("health",t[r].getParameter("health")+e.getParameter("power")):t[r].setParameter("health",t[r].getDefaultParameter("health"))),e._removeInNextTick=!0;break}}},meleeAttack:{update:function(){var e=this.context;if(!e.getParameter("meleeCooldown"))for(var t=e.getParameter("collisions"),r=0;r<t.length;r++)if("player"==t[r].type){t[r].setParameter("health",t[r].getParameter("health")-e.getParameter("power"));var a=i.default.getConfig("bloodSpray");a.pos=t[r].pos.clone(),a.pos.x+=2,a.pos.y+=-10,e.layer.addObject(a),e.setParameter("meleeCooldown",e.getParameter("cooldown"));break}}},monsterExplosion:{update:function(){var e=this.context;if(!e.getParameter("exploded")){for(var t=e.getParameter("collisions"),r=0,a=t.length;r<a;r++)if(t[r].getParameter("health")){t[r].setParameter("health",t[r].getParameter("health")-e.getParameter("power"));break}e.setParameter("exploded",!0)}}},monsterExplosionCondition:{update:function(){function e(){var e,r,a=t.pos.clone(),o=t.getParameter("power");t._removeInNextTick=!0,e=i.default.getConfig("monsterExplosion"),e.pos=new Phaser.Point(a.x-t.size[0],a.y-t.size[1]),r=t.layer.addObject(e),r.setParameter("power",o),e=i.default.getConfig("monsterExplosion"),e.pos=new Phaser.Point(a.x+t.size[0],a.y-t.size[1]),r=t.layer.addObject(e),r.setParameter("power",o),e=i.default.getConfig("monsterExplosion"),e.pos=new Phaser.Point(a.x-t.size[0],a.y+t.size[1]),r=t.layer.addObject(e),r.setParameter("power",o),e=i.default.getConfig("monsterExplosion"),e.pos=new Phaser.Point(a.x+t.size[0],a.y+t.size[1]),r=t.layer.addObject(e),r.setParameter("power",o),e=i.default.getConfig("monsterExplosion"),e.pos=new Phaser.Point(a.x-1.5*t.size[0],a.y),r=t.layer.addObject(e),r.setParameter("power",o),e=i.default.getConfig("monsterExplosion"),e.pos=new Phaser.Point(a.x+1.5*t.size[0],a.y),r=t.layer.addObject(e),r.setParameter("power",o)}var t=this.context;if(t.getParameter("health")<=0)e();else for(var r=t.getParameter("collisions"),a=0;a<r.length;a++)if("player"==r[a].type){e();break}}},stopOnCollisionWithPlayer:{update:function(){for(var e=this.context,t=e.getParameter("collisions"),r=0,a=t.length;r<a;r++)if("player"==t[r].type){e.setParameter("speed",0);break}}},resetSpeed:{update:function(){var e=this.context;e.setParameter("speed",e.getDefaultParameter("speed"))}},resetEffects:{update:function(){this.context.getParameter("effects").splice(0)}},moveToDirection:{update:function(e){var t=this.context,r=t.getParameter("direction");r&&t.setPosition(s.default.moveWithSpeed(t.pos,r,t.getParameter("speed")*e))}},playerLevelUp:{update:function(){var e=this.context,t=e.getParameter("levelTable")[e.getParameter("level")];e.getParameter("levelTable")[e.getParameter("level")]?e.getParameter("exp")>e.getParameter("levelTable")[e.getParameter("level")]&&(e.setParameter("exp",e.getParameter("exp")-t),e.setParameter("level",e.getParameter("level")+1),e.setParameter("spellPower",e.getParameter("spellPower")+1)):e.setParameter("level","MAX")}},monsterHealthStatus:{update:function(){var e=this.context;if(e.getParameter("health")<=0){e._removeInNextTick=!0;var t=i.default.getConfig("explosion");t.pos=e.pos.clone(),e.layer.addObject(t);var r=i.default.getConfig("blood");r.pos=e.pos.clone(),e.layer.addObject(r),e.layer.state.parameters.monstersKilled||(e.layer.state.parameters.monstersKilled=0);var a=e.layer.getObjectsByType("monsterController")[0];a.setParameter("monsterKilled",a.getParameter("monsterKilled")+1),e.layer.state.parameters.monstersKilled++;var o=e.layer.getObjectsByType("player")[0];o.setParameter("exp",o.getParameter("exp")+e.getParameter("exp"))}}},resetRangeCooldown:{update:function(){var e=this.context,t=e.getParameter("fireCooldown");t&&e.setParameter("fireCooldown",t-1)}},resetMeleeCooldown:{update:function(){var e=this.context,t=e.getParameter("meleeCooldown");t&&e.setParameter("meleeCooldown",t-1)}},monsterBossLogic:{update:function(){var e=this.context,t=e.layer.getObjectsByType("player")[0];if(!e.getParameter("fireCooldown")){var r=i.default.getConfig("mbullet"),a=Phaser.Point.subtract(t.pos,e.pos);r.pos=e.pos.clone();var o=e.layer.addObject(r);o.setParameter("direction",a),o.sprite.setDegree(e.pos.angle(t.pos)),e.setParameter("fireCooldown",e.getParameter("cooldown"))}}},monsterBoss2Logic:{update:function(e){var t=this.context,r=t.layer.getObjectsByType("player")[0],a=t.getParameter("direction");if(Phaser.Point.distance(t.pos,r.pos)<t.getParameter("fireRange")){if(!t.getParameter("fireCooldown")){var o=i.default.getConfig("mbullet2");o.pos=t.pos.clone();var n=t.layer.addObject(o);n.setParameter("direction",a),t.setParameter("fireCooldown",t.getParameter("cooldown"))}}else t.setPosition(s.default.moveWithSpeed(t.pos,a,t.getParameter("speed")*e))}},monsterBoss2Bullet:{update:function(){function e(){var e,r,a=t.pos.clone(),o=t.getParameter("power");e=i.default.getConfig("monsterExplosion"),e.pos=new Phaser.Point(a.x,a.y),r=t.layer.addObject(e),r.setParameter("power",o)}var t=this.context,r=t.getParameter("cooldown"),a=t.getParameter("collisions");if(0==r)return t._removeInNextTick=!0,void e();t.setParameter("cooldown",r-1);for(var o=0;o<a.length;o++)if("player"==a[o].type){t._removeInNextTick=!0,e();break}}},moveWithKeyboard:{update:function(){var e=this.context,t=e.pos.clone(),r={};r.left=e.layer.game.input.keyboard.isDown(65),r.up=e.layer.game.input.keyboard.isDown(87),r.down=e.layer.game.input.keyboard.isDown(83),r.right=e.layer.game.input.keyboard.isDown(68),r.right&&(t.x=e.pos.x+1),r.left&&(t.x=e.pos.x-1),r.down&&(t.y=e.pos.y+1),r.up&&(t.y=e.pos.y-1),e.pos.x==t.x&&e.pos.y==t.y?e.setParameter("direction",null):e.setParameter("direction",Phaser.Point.subtract(t,e.pos))}},selectSpellWithKeyboard:{update:function(){var e=this.context;e.layer.game.input.keyboard.isDown(49)&&e.setParameter("currentSpell","fireball"),e.layer.game.input.keyboard.isDown(50)&&e.setParameter("currentSpell","hellfire"),e.layer.game.input.keyboard.isDown(51)&&e.setParameter("currentSpell","frostShard"),e.layer.game.input.keyboard.isDown(52)&&e.setParameter("currentSpell","teleport")}},triggerOnPlayerCollisionPowerUp:{update:function(){for(var e=this.context,t=e.getParameter("collisions"),r=0;r<t.length;r++)if("player"==t[r].type){t[r].setParameter("exp",t[r].getParameter("exp")+e.getParameter("exp")),e._removeInNextTick=!0;break}}},summonOnCooldown:{update:function(){var e=this.context,t=e.getParameter("cooldown");if(0==t){var r=function(){var t,r=100*Math.random();return r<=e.getParameter("chanceOfBoss")?t=i.default.getConfig("monsterBoss"):r-=e.getParameter("chanceOfBoss"),!t&&r<=e.getParameter("chanceOfBoss2")?t=i.default.getConfig("monsterBoss2"):r-=e.getParameter("chanceOfBoss2"),!t&&r<=e.getParameter("chanceOfBoomer")?t=i.default.getConfig("monsterBoomer"):r-=e.getParameter("monsterBoomer"),t||(t=i.default.getConfig("monster")),t}(),a=e.layer.getObjectsByType("player")[0];r.pos=e.pos.clone();var o=e.layer.addObject(r);a.getParameter("level")>1&&o.setParameter("health",.75*o.getParameter("health")*a.getParameter("level")),e._removeInNextTick=!0}else e.setParameter("cooldown",t-1)}}};t.default=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(1),o=function(e){return e&&e.__esModule?e:{default:e}}(a),s=r(2),n={random_trees:{init:function(){function e(){return[Math.round(Math.random()*t.size[0]),Math.round(Math.random()*t.size[1])]}for(var t=this.context,r=0;r<this.parameters.trees;r++){var a=o.default.getConfig("tree"+(Math.round(Math.random())+1)),s=e(this.parameters.area);a.pos=new Phaser.Point(s[0],s[1]),this.context.addObject(a)}for(var n=0;n<this.parameters.stones;n++){var i=o.default.getConfig("stones"),l=e(this.parameters.area);i.pos=new Phaser.Point(l[0],l[1]),this.context.addObject(i)}},parameters:{trees:100,stones:100}},spawn_heart:{update:function(){if(this.parameters.currentCooldown)this.parameters.currentCooldown--;else{var e=o.default.getConfig("heart"),t=new s(50,50),r=new s(1154,918),a=s(10,20).randomize(t,r).toArray();e.pos=new Phaser.Point(a[0],a[1]),this.context.addObject(e),this.parameters.currentCooldown=this.parameters.cooldown}},parameters:{area:[[50,50],[1154,918]],cooldown:400}},spawn_powerup:{update:function(){if(this.parameters.currentCooldown)this.parameters.currentCooldown--;else{var e=o.default.getConfig("powerup"),t=new s(100,100),r=new s(1100,850),a=s(10,20).randomize(t,r).toArray();e.pos=new Phaser.Point(a[0],a[1]),this.context.addObject(e),this.parameters.currentCooldown=this.parameters.cooldown}},parameters:{area:[[100,100],[1100,850]],currentCooldown:1100,cooldown:1100}},spawn_terrain:{init:function(){for(var e,t=o.default.getConfig("gate"),r=0;r<7;r++){e=o.default.getConfig("wall"),e.pos=[e.size[0]*r+e.size[0]/2,e.size[1]/2];this.context.addObject(e)}t.pos=[e.pos.x+e.size[0]/2+t.size[0]/2,(t.size[1]-3)/2];this.context.addObject(t)}},goWithPlayer:{update:function(e){var t=this.context,r=t.getObjectsByType("player")[0],a=(r.pos.x+t.translate.x)/1024*100,o=(r.pos.y+t.translate.y)/768*100;a<30&&t.translate.x<0&&(t.translate.x+=Math.round(r.getParameter("speed")*e)),a>70&&t.translate.x>-300&&(t.translate.x-=Math.round(r.getParameter("speed")*e)),o<25&&t.translate.y<0&&(t.translate.y+=Math.round(r.getParameter("speed")*e)),o>75&&t.translate.y>-300&&(t.translate.y-=Math.round(r.getParameter("speed")*e))}}};t.default=n},function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=r(0),s=(a(o),r(3)),n=a(s),i={countMonsterKilled:{update:function(){var e=this.context,t=e.getParameter("template");e.setParameter("text",(0,n.default)(t,{kills:e.layer.state.parameters.monstersKilled||0}))}},timer:{update:function(){var e=this.context,t=e.getParameter("template");e.setParameter("text",(0,n.default)(t,{time:(e.layer.state.parameters.gameTimer++/60).toFixed(2)}))}},health:{update:function(){var e=this.context,t=e.getParameter("template");e.setParameter("text",(0,n.default)(t,{health:e.layer.getObjectsByType("player")[0].parameters.health}))}},level:{update:function(){var e=this.context,t=e.getParameter("template"),r=e.layer.getObjectsByType("player")[0];e.setParameter("text",(0,n.default)(t,{level:r.getParameter("level"),exp:r.getParameter("exp"),levelExp:r.getParameter("levelTable")[r.getParameter("level")]}))}},bestTime:{init:function(){var e=this.context,t=e.getParameter("template");e.setParameter("text",(0,n.default)(t,{time:(e.layer.state.parameters.bestTime/60).toFixed(2)}))}},bestScore:{init:function(){var e=this.context,t=e.getParameter("template");e.setParameter("text",(0,n.default)(t,{score:e.layer.state.parameters.bestScore}))}}};t.default=i},function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=r(0),s=a(o),n=r(1),i=a(n),l=r(2),u={bindPositionToLayer:{update:function(){var e=this.context;e.pos.x-e.sprite.size[0]/2<e.layer.pos.x?e.pos.x=e.sprite.size[0]/2:e.pos.x+e.sprite.size[0]/2>e.layer.pos.x+e.layer.size[0]&&(e.pos.x=e.layer.pos.x+e.layer.size[0]-e.sprite.size[0]/2),e.pos.y-e.sprite.size[1]/2<e.layer.pos.y?e.pos.y=e.sprite.size[1]/2:e.pos.y+e.sprite.size[1]/2>e.layer.pos.y+e.layer.size[1]&&(e.pos.y=e.layer.pos.y+e.layer.size[1]-e.sprite.size[1]/2)}},destroyAfterLeavingLayer:{update:function(){var e=this.context;if(e.pos.y<-100||e.pos.y-e.sprite.size[1]-100>e.layer.pos.y+e.layer.size[1]||e.pos.x-e.sprite.size[0]-100>e.layer.pos.x+e.layer.size[0]||e.pos.x<-100)return e._removeInNextTick=!0,!1}},setDirectionToPlayer:{update:function(){var e=this.context,t=e.layer.getObjectsByType("player")[0];e.setParameter("direction",Phaser.Point.subtract(t.pos,e.pos))}},setDirectionToPlayerAdvance:{update:function(){var e=this.context,t=e.layer.getObjectsByType("player")[0],r=t.getParameter("direction"),a=e.getParameter("direction");if(a||(a=Phaser.Point.subtract(t.pos,e.pos)),null==r)e.setParameter("direction",Phaser.Point.subtract(t.pos,e.pos));else{var o=Math.abs(Math.min(t.getParameter("speed"),Phaser.Point.distance(e.pos,t.pos))-10),n=s.default.moveWithSpeed(t.pos,r,o),i=Phaser.Point.subtract(n,e.pos).normalize(),l=a.clone().normalize(),u=Phaser.Point.add(l,i).normalize();e.setParameter("direction",u)}}},wandererAI:{init:function(){var e=new l(100,100),t=new l(1100,850),r=l(10,20).randomize(e,t).toArray();this.context.setParameter("direction",new Phaser.Point(r[0],r[1]))},update:function(){var e=this.context,t=e.layer.getObjectsByType("player")[0];if(Phaser.Point.distance(e.pos,t.pos)<=e.getParameter("scentRange"))e.setParameter("scent",!0),e.setParameter("speed",e.getDefaultParameter("scentSpeed")),e.setParameter("wanderCooldown",0),e.setParameter("direction",Phaser.Point.subtract(t.pos,e.pos));else if(e.setParameter("speed",e.getDefaultParameter("speed")),e.getParameter("wanderCooldown"))e.getParameter("wanderCooldown")&&e.setParameter("wanderCooldown",e.getParameter("wanderCooldown")-1);else{var r=new l(100,100),a=new l(1100,850),o=l(10,20).randomize(r,a).toArray();e.setParameter("direction",Phaser.Point.subtract(new Phaser.Point(o[0],o[1]),e.pos)),e.setParameter("wanderCooldown",Math.round(Math.random()*(e.getDefaultParameter("wanderCooldown")-100)+100))}}},dynamicZIndex:{update:function(){var e=this.context,t=0;e.pos&&(t+=e.pos.y),e.sprite&&(t+=e.sprite.size[1]/2),e.zIndex=e.pos.y>0?Math.round(t):0}},collisions:{init:function(){var e=this.context;e.setParameter("collisions",[]).cells=new Array,e.layer.state.collisions.updateObject(e)},update:function(){var e=this.context;e.getParameter("collisions").splice(0),e.layer.state.collisions.updateObject(e)}},rotateToMouse:{update:function(){var e=this.context,t=new Phaser.Point(e.layer.game.input.mousePointer.x,e.layer.game.input.mousePointer.y);t.x-=e.layer.translate.x,t.y-=e.layer.translate.y;var r=Phaser.Point.subtract(t,e.pos);e.sprite.rotateToDirection(r)}},bindPositionToMouse:{update:function(){var e=this.context,t=new Phaser.Point(e.layer.game.input.mousePointer.x,e.layer.game.input.mousePointer.y);e.setPosition(t.clone())}},removeOnCooldown:{update:function(){var e=this.context,t=e.getParameter("cooldown");0==t?e._removeInNextTick=!0:e.setParameter("cooldown",t-1)}},explosionOnCooldown:{update:function(){var e=this.context,t=e.getParameter("cooldown");if(0==t){e._removeInNextTick=!0;var r=i.default.getConfig("monsterExplosion");r.pos=new Phaser.Point(e.pos.x,e.pos.y);e.layer.addObject(r).setParameter("power",e.getParameter("power"))}else e.setParameter("cooldown",t-1)}},explosionAfterSpriteDone:{update:function(){var e=this.context;if(e.sprite.done){e._removeInNextTick=!0;var t=i.default.getConfig("monsterExplosion");t.pos=new Phaser.Point(e.pos.x,e.pos.y);e.layer.addObject(t).setParameter("power",e.getParameter("power"))}}},destroyAfterSpriteDone:{update:function(){var e=this.context;e.sprite.done&&(e._removeInNextTick=!0)}},rotateByDirection:{update:function(){var e=this.context;e.sprite.rotateToDirection(e.getParameter("direction"))}},rotateByPlayer:{update:function(){var e=this.context,t=e.layer.getObjectsByType("player")[0];e.sprite.rotateToDirection(Phaser.Point.subtract(t.pos,e.pos))}}};t.default=u},function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),n=r(0),i=a(n),l=r(29),u=a(l),c=r(30),p=a(c),d=r(1),h=a(d),f=r(4),m=a(f),y=function(){function e(t){o(this,e),this.layer=t.layer,t.pos instanceof Phaser.Point?this.pos=t.pos.clone():t.pos?this.pos=new Phaser.Point(t.pos[0],t.pos[1]):this.pos=new Phaser.Point,this.id=t.id,t.sprite&&(this.sprite=new p.default(this.layer.game.cache,t.sprite[0],t.sprite[1],t.sprite[2],t.sprite[3],t.sprite[4],t.sprite[5],t.sprite[6],t.sprite[7])),this.type=t.type,(t.size||this.sprite)&&(this.size=t.size||this.sprite.size),this.collisions=t.collisions,this.callbacks=t.callbacks||{},this.zIndex=t.zIndex||0;var r=t.parameters||{},a=t.parameters&&i.default.clone(t.parameters)||{};this.size=t.size,this.getParameter=function(e){return a[e]},this.setParameter=function(e,t){return a[e]=t,a[e]},this.getDefaultParameter=function(e){return r[e]},this.rules=t.rules||[],this.conditions=t.conditions||[],this._update=t.update,t.render?u.default[t.render]?this.customRender=u.default[t.render]:this.customRender=t.render:!1===t.render&&(this.noRender=!0),this._init=t.init,this.inited=!1}return s(e,[{key:"render",value:function(e){var t=this;this.noRender||(this.customRender?Array.isArray(this.customRender)?this.customRender.forEach(function(r){return r(t,e)}):this.customRender(this,e):u.default.sprite(this,e))}},{key:"init",value:function(){if(!this.inited){var e=this.rules,t=this.conditions;this.rules=[],this.conditions=[],this._init&&this._init(),this.collisions&&(this.collisions=new m.default(h.default.getRuleConfig("collisions")),this.collisions.setContext(this),this.collisions.init());for(var r=0,a=e.length;r<a;r++)this.addRule(h.default.getRuleConfig(e[r]));for(var o=0,s=t.length;o<s;o++)this.addCondition(h.default.getRuleConfig(t[o]));this.inited=!0}}},{key:"update",value:function(e){this._update&&this._update(),this.rules.forEach(function(t){return t.update(e)})}},{key:"updateConditions",value:function(e){this.conditions.forEach(function(t){return t.update(e)})}},{key:"setPosition",value:function(e){this.pos.x=e.x,this.pos.y=e.y}},{key:"addRule",value:function(e){var t=new m.default(e);t.setContext(this),t.init(),this.rules.push(t)}},{key:"addCondition",value:function(e){var t=new m.default(e);t.setContext(this),t.init(),this.conditions.push(t)}},{key:"updateCollisions",value:function(e){this.collisions&&this.collisions.update(e,this)}}]),e}();t.default=y},function(e,t,r){"use strict";function a(e){var t=e.layer.ctx,r=e.layer.getObjectsByType("player")[0].pos.x,a=e.layer.getObjectsByType("player")[0].pos.y,o=e.layer.ctx.createRadialGradient(r,a,0,r,a,700);o.addColorStop(0,"rgba(0, 0, 0, 0)"),o.addColorStop(1,"rgba(0, 0, 0, 0.97)"),t.fillStyle=o,t.beginPath(),t.arc(r,a,2e3,0,2*Math.PI,!1),t.closePath(),t.fill()}function o(e){var t=e.layer.ctx,r=Math.round(-e.sprite.size[0]/2),a=Math.round(-e.sprite.size[1]/2-7),o=e.sprite.size[0];t.globalAlpha=.5,e.getParameter("health")>0&&e.getDefaultParameter("health")>e.getParameter("health")&&(t.fillStyle="rgb(250, 0, 0)",t.fillRect(r,a,o,3),t.fillStyle="rgb(0, 250, 0)",t.fillRect(r,a,Math.round(o*(e.getParameter("health")/e.getDefaultParameter("health"))),3)),t.globalAlpha=1}function s(e){var t=e.layer.ctx,r=e.layer.getObjectsByType("player")[0];t.translate(-e.layer.translate.x,-e.layer.translate.y),t.globalAlpha=.3,t.fillStyle="rgb(220, 220, 220)",t.fillRect(-22,17,200,40),t.globalAlpha=1,t.fillStyle="#DAA520",r.getParameter("levelTable")[r.getParameter("level")]?t.fillRect(-22,17,Math.min(200,Math.round(r.getParameter("exp")/r.getParameter("levelTable")[r.getParameter("level")]*200)),40):t.fillRect(-22,17,200,40),t.translate(e.layer.translate.x,e.layer.translate.y),f(e)}function n(e,t){var r=e.layer.ctx;r.globalAlpha=1,e.sprite.update(t),e.sprite.render(r)}function i(e,t,r,a,o,s,n,i){e.save(),e.translate(t,r),e.rotate(s),e.translate(-a,-o),e.scale(a,o),e.arc(1,1,1,n,i,!1),e.restore()}function l(e){if(e.size){var t=e.layer.ctx;t.globalAlpha=.5,t.beginPath(),i(t,0,+e.sprite.size[1]/2-3,Math.min(e.sprite.size[0],e.size[0])/2+8,5,0,0,2*Math.PI),t.fillStyle="black",t.fill(),t.globalAlpha=1}}function u(e){for(var t=e.layer.ctx,r=e.getParameter("effects"),a=0;a<r.length;a++){"frozen"==r[a]&&(t.globalAlpha=.8,t.drawImage(e.layer.game.cache.getImage("frostEffect"),-16,+e.sprite.size[1]/2-32,32,32),t.globalAlpha=1)}}function c(e,t){l(e),n(e,t)}function p(e,t){l(e),o(e),n(e,t),u(e)}function d(e,t){var r=e.layer.ctx,a=Math.round(-e.sprite.size[0]/2-4),o=Math.round(-e.sprite.size[1]/2-4),s=e.sprite.size[0]+8,i=e.sprite.size[1]+8;r.translate(-e.layer.translate.x,-e.layer.translate.y),-1!=e.id.indexOf(e.layer.getObjectsByType("player")[0].getParameter("currentSpell"))&&(r.fillStyle="rgb(0, 250, 0)",r.fillRect(a-2,o-2,s+4,i+4)),r.globalAlpha=.4,r.fillStyle="rgb(0, 0, 0)",r.fillRect(a,o,s,i),r.fillStyle="rgb(0, 0, 0)",r.fillRect(a,o,s,i),r.globalAlpha=1,n(e,t),e.getParameter("fireCooldown")>0&&(r.globalAlpha=.8,r.fillStyle="rgb(20, 20, 20)",r.fillRect(a,Math.round(o+i-i*(e.getParameter("fireCooldown")/e.getParameter("cooldown"))),s,i),r.globalAlpha=1),r.translate(e.layer.translate.x,e.layer.translate.y)}function h(e,t){var r=e.layer.ctx;r.translate(-e.layer.translate.x,-e.layer.translate.y),n(e,t),r.translate(e.layer.translate.x,e.layer.translate.y)}function f(e){var t=e.layer.ctx,r="";t.translate(-e.layer.translate.x,-e.layer.translate.y),e.getParameter("style")&&(r+=e.getParameter("style")+" "),e.getParameter("weight")&&(r+=e.getParameter("weight")+" "),r+=(e.getParameter("size")||30)+"pt ",r+=e.getParameter("font")||"Arial",e.getParameter("align")&&(t.textAlign=e.getParameter("align")),t.font=r,t.fillStyle=e.getParameter("color")||"#FFF",t.fillText(e.getParameter("text"),e.pos.x,e.pos.y),t.translate(e.layer.translate.x,e.layer.translate.y)}Object.defineProperty(t,"__esModule",{value:!0});var m={shadow:l,fog:a,expBar:s,healthBar:o,sprite:n,effects:u,ui:h,object:c,text:f,spell:d,unit:p};t.default=m},function(e,t,r){"use strict";function a(e,t,r,a,o,n,i,l,u){this.cache=e,r instanceof Phaser.Point?this.pos=r.clone():this.pos=new Phaser.Point(r[0],r[1]),this.defaultPosition=this.pos.clone(),this.size=a,this.speed="number"==typeof o?o:0,this.frames=s.default.clone(n),this._index=0,this.url=t,this.dir=i||"horizontal",this.once=l,this.degree=u||0}Object.defineProperty(t,"__esModule",{value:!0});var o=r(0),s=function(e){return e&&e.__esModule?e:{default:e}}(o);a.prototype.update=function(e){this._index+=this.speed*e},a.prototype.updateConfig=function(e){e&&(e.pos&&(this.pos=e.pos),e.size&&(this.size=e.size),e.speed&&(this.speed="number"==typeof e.speed?e.speed:0),e.frames&&(this.frames=e.frames),e.url&&(this.url=e.url),e.dir&&(this.dir=e.dir),e.once&&(this.once=e.once),e.degree&&(this.degree=e.degree))},a.prototype.rotateToDirection=function(e){var t=this.defaultPosition,r={},a=e.angle(new Phaser.Point(0,0),!0);r.pos=a>135||a<-135?[t.x,t.y+2*this.size[1]]:a<135&&a>45?[t.x,t.y+3*this.size[1]]:a<45&&a>-45?[t.x,t.y+this.size[1]]:[t.x,t.y],r.pos=new Phaser.Point(r.pos[0],r.pos[1]),this.updateConfig(r)},a.prototype.render=function(e){var t,r=this.pos.x,a=this.pos.y;if(this.speed>0){var o=this.frames.length,s=Math.floor(this._index);if(t=this.frames[s%o],this.once&&s>=o)return void(this.done=!0)}else t=0;"vertical"===this.dir?a+=t*this.size[1]:r+=t*this.size[0],e.rotate(this.degree),e.drawImage(this.cache.getImage(this.url),r,a,this.size[0],this.size[1],Math.round(-this.size[0]/2),Math.round(-this.size[1]/2),this.size[0],this.size[1])},a.prototype.setDegree=function(e){this.degree=e},t.default=a}])});
//# sourceMappingURL=game.bundle.min.js.map